{% extends "base.html" %} {% block body_class %}insurer-page{% endblock %} {% block content %}
<h2>Welcome, {{ name }}!</h2>
<h5>Role: {{ role.capitalize() }}</h5>
<hr />

<div class="row mb-4">
  <div class="col-md-6">
    <h4>Your Information</h4>
    <ul class="list-group">
      {% for key, value in user_info.items() %}
      <li class="list-group-item"><strong>{{ key }}:</strong> {{ value }}</li>
      {% endfor %}
    </ul>
  </div>
</div>

<!-- Pending Claims Section -->
<div class="row mb-4">
  <div class="col-12">
    <h4>Pending Claims</h4>
    {% if pending_claims %}
    <div class="table-responsive">
      <table class="table table-bordered align-middle">
        <thead>
          <tr>
            <th>Claim ID</th>
            <th>Patient</th>
            <th>Record (IPFS)</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          {% for c in pending_claims %}
          <tr>
            <td>{{ c.id }}</td>
            <td>{{ c.patient }}</td>
            <td>
              <a href="https://ipfs.io/ipfs/{{ c.recordHash }}" target="_blank"
                >{{ c.recordHash }}</a
              >
            </td>
            <td>
              <form
                method="POST"
                action="{{ url_for('insurer_settle_claim') }}"
              >
                <input type="hidden" name="claim_id" value="{{ c.id }}" />
                <button type="submit" class="btn btn-success btn-sm">
                  Settle
                </button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <p>No pending claims.</p>
    {% endif %}
  </div>
</div>

<!-- Settled Claims Section -->
<div class="row mb-4">
  <div class="col-12">
    <h4>Settled Claims</h4>
    {% if settled_claims %}
    <ul class="list-group">
      {% for c in settled_claims %}
      <li class="list-group-item">
        Claim #{{ c.id }} for {{ c.patient }} â€“
        <a href="https://ipfs.io/ipfs/{{ c.recordHash }}" target="_blank"
          >{{ c.recordHash }}</a
        >
      </li>
      {% endfor %}
    </ul>
    {% else %}
    <p>No claims settled yet.</p>
    {% endif %}
  </div>
</div>

{% endblock %}
